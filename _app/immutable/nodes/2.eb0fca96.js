import{s as ge,e as ne,f as ae,g as De,u as Ue,h as Ne,j as Fe,d as os,c as de,n as fe,b as et,p as tt}from"../chunks/scheduler.b5cb2f20.js";import{S as me,i as _e,e as ke,a as y,p as mt,t as A,b as _t,d as j,f as m,g as k,h as T,j as R,k as b,r as D,u as U,v as N,A as We,w as F,s as S,m as H,c as E,n as B,l as K,x as C,o as ee,y as Ve,F as Ke,G as st,E as Q,H as ls,I as cs}from"../chunks/index.b54eaf43.js";import{e as ie,P as Ye}from"../chunks/Prose.c88bcef6.js";import{B as oe,g as us,c as St}from"../chunks/sha256.73b255ed.js";import{_ as qe}from"../chunks/preload-helper.a4192956.js";function hs(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in n)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}function ds(n){let e,t;const s=n[9].default,r=De(s,n,n[8],null);return{c(){e=k("div"),r&&r.c(),this.h()},l(i){e=T(i,"DIV",{class:!0,id:!0});var a=R(e);r&&r.l(a),a.forEach(m),this.h()},h(){b(e,"class",n[2]),b(e,"id",n[0])},m(i,a){y(i,e,a),r&&r.m(e,null),t=!0},p(i,a){r&&r.p&&(!t||a&256)&&Ue(r,s,i,i[8],t?Fe(s,i[8],a,null):Ne(i[8]),null),(!t||a&4)&&b(e,"class",i[2]),(!t||a&1)&&b(e,"id",i[0])},i(i){t||(j(r,i),t=!0)},o(i){A(r,i),t=!1},d(i){i&&m(e),r&&r.d(i)}}}function fs(n){let e,t;const s=n[9].default,r=De(s,n,n[8],null);return{c(){e=k("a"),r&&r.c(),this.h()},l(i){e=T(i,"A",{class:!0,id:!0,href:!0});var a=R(e);r&&r.l(a),a.forEach(m),this.h()},h(){b(e,"class",n[2]),b(e,"id",n[0]),b(e,"href",n[1])},m(i,a){y(i,e,a),r&&r.m(e,null),t=!0},p(i,a){r&&r.p&&(!t||a&256)&&Ue(r,s,i,i[8],t?Fe(s,i[8],a,null):Ne(i[8]),null),(!t||a&4)&&b(e,"class",i[2]),(!t||a&1)&&b(e,"id",i[0]),(!t||a&2)&&b(e,"href",i[1])},i(i){t||(j(r,i),t=!0)},o(i){A(r,i),t=!1},d(i){i&&m(e),r&&r.d(i)}}}function gs(n){let e,t,s,r;const i=[fs,ds],a=[];function o(l,c){return l[1]?0:1}return e=o(n),t=a[e]=i[e](n),{c(){t.c(),s=ke()},l(l){t.l(l),s=ke()},m(l,c){a[e].m(l,c),y(l,s,c),r=!0},p(l,[c]){let u=e;e=o(l),e===u?a[e].p(l,c):(mt(),A(a[u],1,1,()=>{a[u]=null}),_t(),t=a[e],t?t.p(l,c):(t=a[e]=i[e](l),t.c()),j(t,1),t.m(s.parentNode,s))},i(l){r||(j(t),r=!0)},o(l){A(t),r=!1},d(l){l&&m(s),a[e].d(l)}}}function ms(n,e,t){let s,{$$slots:r={},$$scope:i}=e,{id:a=""}=e,{href:o=""}=e,{sizes:l="max-w-7xl w-full"}=e,{border:c=""}=e,{padding:u="sm:px-6 lg:px-8 px-4"}=e,{margin:f="mx-auto"}=e,{shadow:d=""}=e;return n.$$set=h=>{t(10,e=ne(ne({},e),ae(h))),"id"in h&&t(0,a=h.id),"href"in h&&t(1,o=h.href),"sizes"in h&&t(3,l=h.sizes),"border"in h&&t(4,c=h.border),"padding"in h&&t(5,u=h.padding),"margin"in h&&t(6,f=h.margin),"shadow"in h&&t(7,d=h.shadow),"$$scope"in h&&t(8,i=h.$$scope)},n.$$.update=()=>{t(2,s=`${l} ${u} ${f} ${d} ${c} ${e.class} relative`)},e=ae(e),[a,o,s,l,c,u,f,d,i,r]}class Me extends me{constructor(e){super(),_e(this,e,ms,gs,ge,{id:0,href:1,sizes:3,border:4,padding:5,margin:6,shadow:7})}}function _s(n){let e,t,s;const r=n[10].default,i=De(r,n,n[9],null);return{c(){e=k("div"),i&&i.c(),this.h()},l(a){e=T(a,"DIV",{class:!0,style:!0});var o=R(e);i&&i.l(o),o.forEach(m),this.h()},h(){b(e,"class",n[1]),b(e,"style",t=n[2].style)},m(a,o){y(a,e,o),i&&i.m(e,null),s=!0},p(a,o){i&&i.p&&(!s||o&512)&&Ue(i,r,a,a[9],s?Fe(r,a[9],o,null):Ne(a[9]),null),(!s||o&2)&&b(e,"class",a[1]),(!s||o&4&&t!==(t=a[2].style))&&b(e,"style",t)},i(a){s||(j(i,a),s=!0)},o(a){A(i,a),s=!1},d(a){a&&m(e),i&&i.d(a)}}}function ps(n){let e,t,s,r;const i=n[10].default,a=De(i,n,n[9],null);return{c(){e=k("a"),a&&a.c(),this.h()},l(o){e=T(o,"A",{class:!0,target:!0,href:!0,style:!0});var l=R(e);a&&a.l(l),l.forEach(m),this.h()},h(){b(e,"class",n[1]),b(e,"target",t=n[2].target),b(e,"href",n[0]),b(e,"style",s=n[2].style)},m(o,l){y(o,e,l),a&&a.m(e,null),r=!0},p(o,l){a&&a.p&&(!r||l&512)&&Ue(a,i,o,o[9],r?Fe(i,o[9],l,null):Ne(o[9]),null),(!r||l&2)&&b(e,"class",o[1]),(!r||l&4&&t!==(t=o[2].target))&&b(e,"target",t),(!r||l&1)&&b(e,"href",o[0]),(!r||l&4&&s!==(s=o[2].style))&&b(e,"style",s)},i(o){r||(j(a,o),r=!0)},o(o){A(a,o),r=!1},d(o){o&&m(e),a&&a.d(o)}}}function vs(n){let e,t,s,r;const i=[ps,_s],a=[];function o(l,c){return l[0]?0:1}return e=o(n),t=a[e]=i[e](n),{c(){t.c(),s=ke()},l(l){t.l(l),s=ke()},m(l,c){a[e].m(l,c),y(l,s,c),r=!0},p(l,[c]){let u=e;e=o(l),e===u?a[e].p(l,c):(mt(),A(a[u],1,1,()=>{a[u]=null}),_t(),t=a[e],t?t.p(l,c):(t=a[e]=i[e](l),t.c()),j(t,1),t.m(s.parentNode,s))},i(l){r||(j(t),r=!0)},o(l){A(t),r=!1},d(l){l&&m(s),a[e].d(l)}}}function bs(n,e,t){let s,{$$slots:r={},$$scope:i}=e,{href:a=""}=e,{size:o="max-w-md"}=e,{border:l=""}=e,{radius:c="rounded-md"}=e,{padding:u=" sm:px-6 lg:px-8 px-4 py-3 sm:py-4 lg:py-6"}=e,{margin:f="mx-auto"}=e,{shadow:d=""}=e;return n.$$set=h=>{t(2,e=ne(ne({},e),ae(h))),"href"in h&&t(0,a=h.href),"size"in h&&t(3,o=h.size),"border"in h&&t(4,l=h.border),"radius"in h&&t(5,c=h.radius),"padding"in h&&t(6,u=h.padding),"margin"in h&&t(7,f=h.margin),"shadow"in h&&t(8,d=h.shadow),"$$scope"in h&&t(9,i=h.$$scope)},n.$$.update=()=>{t(1,s=`${o} ${f}  ${u} ${d} ${l} ${c} ${e.class}`)},e=ae(e),[a,s,e,o,l,c,u,f,d,i,r]}class Et extends me{constructor(e){super(),_e(this,e,bs,vs,ge,{href:0,size:3,border:4,radius:5,padding:6,margin:7,shadow:8})}}function ys(n){let e,t,s,r;const i=n[9].default,a=De(i,n,n[8],null);return{c(){e=k("section"),a&&a.c(),this.h()},l(o){e=T(o,"SECTION",{class:!0,style:!0,id:!0});var l=R(e);a&&a.l(l),l.forEach(m),this.h()},h(){b(e,"class",n[0]),b(e,"style",t=n[1].style),b(e,"id",s=n[1].id)},m(o,l){y(o,e,l),a&&a.m(e,null),r=!0},p(o,[l]){a&&a.p&&(!r||l&256)&&Ue(a,i,o,o[8],r?Fe(i,o[8],l,null):Ne(o[8]),null),(!r||l&1)&&b(e,"class",o[0]),(!r||l&2&&t!==(t=o[1].style))&&b(e,"style",t),(!r||l&2&&s!==(s=o[1].id))&&b(e,"id",s)},i(o){r||(j(a,o),r=!0)},o(o){A(a,o),r=!1},d(o){o&&m(e),a&&a.d(o)}}}function ws(n,e,t){let s,{$$slots:r={},$$scope:i}=e,{background:a=""}=e,{border:o=""}=e,{padding:l=""}=e,{shadow:c=""}=e,{gap:u="gap-6"}=e,{typography:f=""}=e;return n.$$set=d=>{t(1,e=ne(ne({},e),ae(d))),"background"in d&&t(2,a=d.background),"border"in d&&t(3,o=d.border),"padding"in d&&t(4,l=d.padding),"shadow"in d&&t(5,c=d.shadow),"gap"in d&&t(6,u=d.gap),"typography"in d&&t(7,f=d.typography),"$$scope"in d&&t(8,i=d.$$scope)},n.$$.update=()=>{t(0,s=`grid place-items-center relative
   ${a} ${o} ${l} ${c} ${f} ${e.class}`)},e=ae(e),[s,e,a,o,l,c,u,f,i,r]}class we extends me{constructor(e){super(),_e(this,e,ws,ys,ge,{background:2,border:3,padding:4,shadow:5,gap:6,typography:7})}}function Ot(n,e,t){const s=n.slice();return s[13]=e[t][0],s[14]=e[t][1].href,s[15]=e[t][1].highlight,s}function $s(n){let e=n[13]+"",t,s;return{c(){t=H(e),s=S()},l(r){t=B(r,e),s=E(r)},m(r,i){y(r,t,i),y(r,s,i)},p(r,i){i&64&&e!==(e=r[13]+"")&&ee(t,e)},d(r){r&&(m(t),m(s))}}}function jt(n){let e,t;return e=new oe({props:{class:"w-full",highlight:n[15],href:n[14],$$slots:{default:[$s]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment)},l(s){U(e.$$.fragment,s)},m(s,r){N(e,s,r),t=!0},p(s,r){const i={};r&64&&(i.highlight=s[15]),r&64&&(i.href=s[14]),r&262208&&(i.$$scope={dirty:r,ctx:s}),e.$set(i)},i(s){t||(j(e.$$.fragment,s),t=!0)},o(s){A(e.$$.fragment,s),t=!1},d(s){F(e,s)}}}function ks(n){let e,t,s,r,i,a,o,l,c,u,f,d,h,g,v,_,p,$,q,I,J=ie(Object.entries(n[6])),L=[];for(let w=0;w<J.length;w+=1)L[w]=jt(Ot(n,J,w));const Je=w=>A(L[w],1,1,()=>{L[w]=null});return{c(){e=k("div"),s=S(),r=k("div"),i=k("img"),l=S(),c=k("div"),u=k("div"),f=k("h1"),d=H(n[3]),h=S(),g=k("h5"),v=H(n[4]),_=S(),p=k("div");for(let w=0;w<L.length;w+=1)L[w].c();this.h()},l(w){e=T(w,"DIV",{class:!0}),R(e).forEach(m),s=E(w),r=T(w,"DIV",{class:!0});var O=R(r);i=T(O,"IMG",{src:!0,alt:!0,class:!0}),O.forEach(m),l=E(w),c=T(w,"DIV",{class:!0});var M=R(c);u=T(M,"DIV",{class:!0});var X=R(u);f=T(X,"H1",{class:!0,style:!0});var Ee=R(f);d=B(Ee,n[3]),Ee.forEach(m),h=E(X),g=T(X,"H5",{class:!0,style:!0});var Oe=R(g);v=B(Oe,n[4]),Oe.forEach(m),X.forEach(m),_=E(M),p=T(M,"DIV",{class:!0});var Tt=R(p);for(let Ze=0;Ze<L.length;Ze+=1)L[Ze].l(Tt);Tt.forEach(m),M.forEach(m),this.h()},h(){b(e,"class",t=n[1]+" w-full h-full z-0 absolute"),de(i.src,a=n[0])||b(i,"src",a),b(i,"alt",""),b(i,"class","object-cover object-center w-full h-screen max-h-screen"),b(r,"class",o=(n[2]?"fixed":"absolute ")+" w-full h-full not-prose -z-10"),b(f,"class",""),K(f,"margin","0px"),b(g,"class","max-w-6xl"),K(g,"margin","0px"),b(u,"class","flex flex-col items-center gap-4 "),b(p,"class",$="grid grid-cols-"+Object.entries(n[6]).length+" gap-4 md:gap-6 place-items-center w-fit"),b(c,"class",q="flex flex-col w-full z-10 items-center "+n[8]()+" my-auto gap-12 mx-2 sm:mx-4 md:mx-6 "+(n[2]?"fixed":""))},m(w,O){y(w,e,O),y(w,s,O),y(w,r,O),C(r,i),y(w,l,O),y(w,c,O),C(c,u),C(u,f),C(f,d),C(u,h),C(u,g),C(g,v),C(c,_),C(c,p);for(let M=0;M<L.length;M+=1)L[M]&&L[M].m(p,null);I=!0},p(w,O){if((!I||O&2&&t!==(t=w[1]+" w-full h-full z-0 absolute"))&&b(e,"class",t),(!I||O&1&&!de(i.src,a=w[0]))&&b(i,"src",a),(!I||O&4&&o!==(o=(w[2]?"fixed":"absolute ")+" w-full h-full not-prose -z-10"))&&b(r,"class",o),(!I||O&8)&&ee(d,w[3]),(!I||O&16)&&ee(v,w[4]),O&64){J=ie(Object.entries(w[6]));let M;for(M=0;M<J.length;M+=1){const X=Ot(w,J,M);L[M]?(L[M].p(X,O),j(L[M],1)):(L[M]=jt(X),L[M].c(),j(L[M],1),L[M].m(p,null))}for(mt(),M=J.length;M<L.length;M+=1)Je(M);_t()}(!I||O&64&&$!==($="grid grid-cols-"+Object.entries(w[6]).length+" gap-4 md:gap-6 place-items-center w-fit"))&&b(p,"class",$),(!I||O&4&&q!==(q="flex flex-col w-full z-10 items-center "+w[8]()+" my-auto gap-12 mx-2 sm:mx-4 md:mx-6 "+(w[2]?"fixed":"")))&&b(c,"class",q)},i(w){if(!I){for(let O=0;O<J.length;O+=1)j(L[O]);I=!0}},o(w){L=L.filter(Boolean);for(let O=0;O<L.length;O+=1)A(L[O]);I=!1},d(w){w&&(m(e),m(s),m(r),m(l),m(c)),Ve(L,w)}}}function Ts(n){let e=!1,t=()=>{e=!1},s,r,i,a,o;return os(n[11]),r=new we({props:{class:"h-screen w-full z-0 "+n[5],style:n[9].style+" ; clip-path: inset(0 0 0 0);",$$slots:{default:[ks]},$$scope:{ctx:n}}}),{c(){D(r.$$.fragment)},l(l){U(r.$$.fragment,l)},m(l,c){N(r,l,c),i=!0,a||(o=We(window,"scroll",()=>{e=!0,clearTimeout(s),s=setTimeout(t,100),n[11]()}),a=!0)},p(l,[c]){c&128&&!e&&(e=!0,clearTimeout(s),scrollTo(window.pageXOffset,l[7]),s=setTimeout(t,100));const u={};c&32&&(u.class="h-screen w-full z-0 "+l[5]),c&512&&(u.style=l[9].style+" ; clip-path: inset(0 0 0 0);"),c&262239&&(u.$$scope={dirty:c,ctx:l}),r.$set(u)},i(l){i||(j(r.$$.fragment,l),i=!0)},o(l){A(r.$$.fragment,l),i=!1},d(l){F(r,l),a=!1,o()}}}function Ss(n,e,t){let{bgImg:s="/favicon.png"}=e,{bgCover:r="bg-black/0"}=e,{parallax:i=!1}=e,{title:a="This is a great title for Company Name"}=e,{subtitle:o="This is an even better piece of text. Specifically, this is a subtitle"}=e,{typography:l=""}=e,{CTAButtons:c={"CTA ONE":{href:"/",highlight:!0},"CTA TWO":{href:"/",highlight:!1}}}=e,{justified:u="center"}=e,f=()=>{switch(u){case"left":return"items-start text-left";case"right":return"items-end text-right";case"center":return"items-center text-center"}},d;function h(){t(7,d=window.pageYOffset)}return n.$$set=g=>{t(9,e=ne(ne({},e),ae(g))),"bgImg"in g&&t(0,s=g.bgImg),"bgCover"in g&&t(1,r=g.bgCover),"parallax"in g&&t(2,i=g.parallax),"title"in g&&t(3,a=g.title),"subtitle"in g&&t(4,o=g.subtitle),"typography"in g&&t(5,l=g.typography),"CTAButtons"in g&&t(6,c=g.CTAButtons),"justified"in g&&t(10,u=g.justified)},n.$$.update=()=>{n.$$.dirty&128},e=ae(e),[s,r,i,a,o,l,c,d,f,e,u,h]}class Es extends me{constructor(e){super(),_e(this,e,Ss,Ts,ge,{bgImg:0,bgCover:1,parallax:2,title:3,subtitle:4,typography:5,CTAButtons:6,justified:10})}}const Os=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>qe(()=>Promise.resolve().then(()=>ze),void 0,import.meta.url).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class pt extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class js extends pt{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Cs extends pt{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class As extends pt{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Is=globalThis&&globalThis.__awaiter||function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(f){a(f)}}function l(u){try{c(s.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((s=s.apply(n,e||[])).next())})};class Rs{constructor(e,{headers:t={},customFetch:s}={}){this.url=e,this.headers=t,this.fetch=Os(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return Is(this,void 0,void 0,function*(){try{const{headers:r,method:i,body:a}=t;let o={},l;a&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",l=a):typeof a=="string"?(o["Content-Type"]="text/plain",l=a):typeof FormData<"u"&&a instanceof FormData?l=a:(o["Content-Type"]="application/json",l=JSON.stringify(a)));const c=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),r),body:l}).catch(h=>{throw new js(h)}),u=c.headers.get("x-relay-error");if(u&&u==="true")throw new Cs(c);if(!c.ok)throw new As(c);let f=((s=c.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),d;return f==="application/json"?d=yield c.json():f==="application/octet-stream"?d=yield c.blob():f==="multipart/form-data"?d=yield c.formData():d=yield c.text(),{data:d,error:null}}catch(r){return{data:null,error:r}}})}}var ut={exports:{}};(function(n,e){var t=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof St<"u")return St;throw new Error("unable to locate global object")},s=t();n.exports=e=s.fetch,s.fetch&&(e.default=s.fetch.bind(s)),e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response})(ut,ut.exports);var vt=ut.exports;const bt=us(vt),ze=hs({__proto__:null,default:bt},[vt]);class xs{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=bt:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const s=this.fetch;let r=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var a,o,l;let c=null,u=null,f=null,d=i.status,h=i.statusText;if(i.ok){if(this.method!=="HEAD"){const p=await i.text();p===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=p:u=JSON.parse(p))}const v=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),_=(o=i.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");v&&_&&_.length>1&&(f=parseInt(_[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,f=null,d=406,h="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const v=await i.text();try{c=JSON.parse(v),Array.isArray(c)&&i.status===404&&(u=[],c=null,d=200,h="OK")}catch{i.status===404&&v===""?(d=204,h="No Content"):c={message:v}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,d=200,h="OK"),c&&this.shouldThrowOnError)throw c}return{error:c,data:u,count:f,status:d,statusText:h}});return this.shouldThrowOnError||(r=r.catch(i=>{var a,o,l;return{error:{message:`${(a=i==null?void 0:i.name)!==null&&a!==void 0?a:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(o=i==null?void 0:i.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=i==null?void 0:i.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}}class Ps extends xs{select(e){let t=!1;const s=(e??"*").split("").map(r=>/\s/.test(r)&&!t?"":(r==='"'&&(t=!t),r)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:r}={}){const i=r?`${r}.order`:"order",a=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t}={}){const s=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:s}={}){const r=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:r=!1,wal:i=!1,format:a="text"}={}){const o=[e?"analyze":null,t?"verbose":null,s?"settings":null,r?"buffers":null,i?"wal":null].filter(Boolean).join("|"),l=this.headers.Accept;return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${l}"; options=${o};`,a==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class $e extends Ps{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=t.map(r=>typeof r=="string"&&new RegExp("[,()]").test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:r}={}){let i="";r==="plain"?i="pl":r==="phrase"?i="ph":r==="websearch"&&(i="w");const a=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${i}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,s])=>{this.url.searchParams.append(t,`eq.${s}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t}={}){const s=t?`${t}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}}class Ls{constructor(e,{headers:t={},schema:s,fetch:r}){this.url=e,this.headers=t,this.schema=s,this.fetch=r}select(e,{head:t=!1,count:s}={}){const r=t?"HEAD":"GET";let i=!1;const a=(e??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",a),s&&(this.headers.Prefer=`count=${s}`),new $e({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:s=!0}={}){const r="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),s||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const a=e.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new $e({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:r,defaultToNull:i=!0}={}){const a="POST",o=[`resolution=${s?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&o.push(this.headers.Prefer),r&&o.push(`count=${r}`),i||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const l=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new $e({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const s="PATCH",r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),this.headers.Prefer=r.join(","),new $e({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",s=[];return e&&s.push(`count=${e}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new $e({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const Ds="1.8.5",Us={"X-Client-Info":`postgrest-js/${Ds}`};class yt{constructor(e,{headers:t={},schema:s,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},Us),t),this.schemaName=s,this.fetch=r}from(e){const t=new URL(`${this.url}/${e}`);return new Ls(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new yt(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,count:r}={}){let i;const a=new URL(`${this.url}/rpc/${e}`);let o;s?(i="HEAD",Object.entries(t).forEach(([c,u])=>{a.searchParams.append(c,`${u}`)})):(i="POST",o=t);const l=Object.assign({},this.headers);return r&&(l.Prefer=`count=${r}`),new $e({method:i,url:a,headers:l,schema:this.schemaName,body:o,fetch:this.fetch,allowEmpty:!1})}}var rt,Ct;function Ns(){if(Ct)return rt;Ct=1;var n=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};return rt=function(){if(this)return this;if(typeof globalThis=="object"&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return n()}try{return __global__||n()}finally{delete Object.prototype.__global__}}(),rt}const Fs="websocket",qs="Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",Ms=["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],zs="Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",Js=["IÃ±aki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],Hs="1.0.34",Bs={type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},Gs="https://github.com/theturtle32/WebSocket-Node",Vs={node:">=4.0.0"},Ks={bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},Ws={"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},Ys={verbose:!1},Xs={test:"tape test/unit/*.js",gulp:"gulp"},Qs="index",Zs={lib:"./lib"},er="lib/browser.js",tr="Apache-2.0",sr={name:Fs,description:qs,keywords:Ms,author:zs,contributors:Js,version:Hs,repository:Bs,homepage:Gs,engines:Vs,dependencies:Ks,devDependencies:Ws,config:Ys,scripts:Xs,main:Qs,directories:Zs,browser:er,license:tr};var rr=sr.version,ue;if(typeof globalThis=="object")ue=globalThis;else try{ue=Ns()}catch{}finally{if(!ue&&typeof window<"u"&&(ue=window),!ue)throw new Error("Could not determine global this")}var Pe=ue.WebSocket||ue.MozWebSocket,ir=rr;function Qt(n,e){var t;return e?t=new Pe(n,e):t=new Pe(n),t}Pe&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(n){Object.defineProperty(Qt,n,{get:function(){return Pe[n]}})});var nr={w3cwebsocket:Pe?Qt:null,version:ir};const ar="2.8.1",or={"X-Client-Info":`realtime-js/${ar}`},lr="1.0.0",Zt=1e4,cr=1e3;var Ie;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Ie||(Ie={}));var V;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(V||(V={}));var Y;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Y||(Y={}));var ht;(function(n){n.websocket="websocket"})(ht||(ht={}));var he;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(he||(he={}));class es{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class ur{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const r=t.getUint8(1),i=t.getUint8(2);let a=this.HEADER_LENGTH+2;const o=s.decode(e.slice(a,a+r));a=a+r;const l=s.decode(e.slice(a,a+i));a=a+i;const c=JSON.parse(s.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class it{constructor(e,t,s={},r=Zt){this.channel=e,this.event=t,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null,this.rateLimited=!1}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){if(this._hasReceived("timeout"))return;this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()})==="rate limited"&&(this.rateLimited=!0)}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var At;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(At||(At={}));class Re{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},r=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Re.syncState(this.state,r,i,a),this.pendingDiffs.forEach(l=>{this.state=Re.syncDiff(this.state,l,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(s.diff,{},r=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=Re.syncDiff(this.state,r,i,a),o())}),this.onJoin((r,i,a)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:i,newPresences:a})}),this.onLeave((r,i,a)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,r){const i=this.cloneDeep(e),a=this.transformState(t),o={},l={};return this.map(i,(c,u)=>{a[c]||(l[c]=u)}),this.map(a,(c,u)=>{const f=i[c];if(f){const d=u.map(_=>_.presence_ref),h=f.map(_=>_.presence_ref),g=u.filter(_=>h.indexOf(_.presence_ref)<0),v=f.filter(_=>d.indexOf(_.presence_ref)<0);g.length>0&&(o[c]=g),v.length>0&&(l[c]=v)}else o[c]=u}),this.syncDiff(i,{joins:o,leaves:l},s,r)}static syncDiff(e,t,s,r){const{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(i,(o,l)=>{var c;const u=(c=e[o])!==null&&c!==void 0?c:[];if(e[o]=this.cloneDeep(l),u.length>0){const f=e[o].map(h=>h.presence_ref),d=u.filter(h=>f.indexOf(h.presence_ref)<0);e[o].unshift(...d)}s(o,u,l)}),this.map(a,(o,l)=>{let c=e[o];if(!c)return;const u=l.map(f=>f.presence_ref);c=c.filter(f=>u.indexOf(f.presence_ref)<0),e[o]=c,r(o,c,l),c.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const r=e[s];return"metas"in r?t[s]=r.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[s]=r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var z;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(z||(z={}));const It=(n,e,t={})=>{var s;const r=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((i,a)=>(i[a]=hr(a,n,e,r),i),{})},hr=(n,e,t,s)=>{const r=e.find(o=>o.name===n),i=r==null?void 0:r.type,a=t[n];return i&&!s.includes(i)?ts(i,a):dt(a)},ts=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return mr(e,t)}switch(n){case z.bool:return dr(e);case z.float4:case z.float8:case z.int2:case z.int4:case z.int8:case z.numeric:case z.oid:return fr(e);case z.json:case z.jsonb:return gr(e);case z.timestamp:return _r(e);case z.abstime:case z.date:case z.daterange:case z.int4range:case z.int8range:case z.money:case z.reltime:case z.text:case z.time:case z.timestamptz:case z.timetz:case z.tsrange:case z.tstzrange:return dt(e);default:return dt(e)}},dt=n=>n,dr=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},fr=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},gr=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},mr=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,s=n[t];if(n[0]==="{"&&s==="}"){let i;const a=n.slice(1,t);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>ts(e,o))}return n},_r=n=>typeof n=="string"?n.replace(" ","T"):n;var Rt;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Rt||(Rt={}));var xt;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes"})(xt||(xt={}));var Pt;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(Pt||(Pt={}));class wt{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=V.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},t.config),this.timeout=this.socket.timeout,this.joinPush=new it(this,Y.join,this.params,this.timeout),this.rejoinTimer=new es(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=V.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=V.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=V.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=V.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Y.reply,{},(r,i)=>{this._trigger(this._replyEventName(i),r)}),this.presence=new Re(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(e,t=this.timeout){var s,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:a}}=this.params;this._onError(c=>e&&e("CHANNEL_ERROR",c)),this._onClose(()=>e&&e("CLOSED"));const o={},l={broadcast:i,presence:a,postgres_changes:(r=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(c=>c.filter))!==null&&r!==void 0?r:[]};this.socket.accessToken&&(o.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:l},o)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",({postgres_changes:c})=>{var u;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),c===void 0){e&&e("SUBSCRIBED");return}else{const f=this.bindings.postgres_changes,d=(u=f==null?void 0:f.length)!==null&&u!==void 0?u:0,h=[];for(let g=0;g<d;g++){const v=f[g],{filter:{event:_,schema:p,table:$,filter:q}}=v,I=c&&c[g];if(I&&I.event===_&&I.schema===p&&I.table===$&&I.filter===q)h.push(Object.assign(Object.assign({},v),{id:I.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=h,e&&e("SUBSCRIBED");return}}).receive("error",c=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e,t={}){var s,r;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:a}=e,o={method:"POST",headers:{apikey:(s=this.socket.accessToken)!==null&&s!==void 0?s:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a}]})};try{return(await this._fetchWithTimeout(this.broadcastEndpointURL,o,(r=t.timeout)!==null&&r!==void 0?r:this.timeout)).ok?"ok":"error"}catch(l){return l.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,l;const c=this._push(e.type,e,t.timeout||this.timeout);c.rateLimited&&i("rate limited"),e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=V.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Y.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(s=>{const r=new it(this,Y.leave,{},e);r.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})})}_broadcastEndpointURL(){let e=this.socket.endPoint;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(e,t,s){const r=new AbortController,i=setTimeout(()=>r.abort(),s),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(i),a}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new it(this,e,t,s);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var r,i;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=Y;if(s&&[o,l,c,u].indexOf(a)>=0&&s!==this._joinRef())return;let d=this._onMessage(a,t,s);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(h=>{var g,v,_;return((g=h.filter)===null||g===void 0?void 0:g.event)==="*"||((_=(v=h.filter)===null||v===void 0?void 0:v.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===a}).map(h=>h.callback(d,s)):(i=this.bindings[a])===null||i===void 0||i.filter(h=>{var g,v,_,p,$,q;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in h){const I=h.id,J=(g=h.filter)===null||g===void 0?void 0:g.event;return I&&((v=t.ids)===null||v===void 0?void 0:v.includes(I))&&(J==="*"||(J==null?void 0:J.toLocaleLowerCase())===((_=t.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const I=($=(p=h==null?void 0:h.filter)===null||p===void 0?void 0:p.event)===null||$===void 0?void 0:$.toLocaleLowerCase();return I==="*"||I===((q=t==null?void 0:t.event)===null||q===void 0?void 0:q.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===a}).map(h=>{if(typeof d=="object"&&"ids"in d){const g=d.data,{schema:v,table:_,commit_timestamp:p,type:$,errors:q}=g;d=Object.assign(Object.assign({},{schema:v,table:_,commit_timestamp:p,eventType:$,new:{},old:{},errors:q}),this._getPayloadRecords(g))}h.callback(d,s)})}_isClosed(){return this.state===V.closed}_isJoined(){return this.state===V.joined}_isJoining(){return this.state===V.joining}_isLeaving(){return this.state===V.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const r=e.toLocaleLowerCase(),i={type:r,filter:t,callback:s};return this.bindings[r]?this.bindings[r].push(i):this.bindings[r]=[i],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(r=>{var i;return!(((i=r.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&wt.isEqual(r.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Y.close,{},e)}_onError(e){this._on(Y.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=V.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=It(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=It(e.columns,e.old_record)),t}}const pr=()=>{};class vr{constructor(e,t){var s,r;this.accessToken=null,this.channels=[],this.endPoint="",this.headers=or,this.params={},this.timeout=Zt,this.transport=nr.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=pr,this.conn=null,this.sendBuffer=[],this.serializer=new ur,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.eventsPerSecondLimitMs=100,this.inThrottle=!1,this._resolveFetch=o=>{let l;return o?l=o:typeof fetch>"u"?l=(...c)=>qe(()=>Promise.resolve().then(()=>ze),void 0,import.meta.url).then(({default:u})=>u(...c)):l=fetch,(...c)=>l(...c)},this.endPoint=`${e}/${ht.websocket}`,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.transport&&(this.transport=t.transport),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const i=(s=t==null?void 0:t.params)===null||s===void 0?void 0:s.eventsPerSecond;i&&(this.eventsPerSecondLimitMs=Math.floor(1e3/i));const a=(r=t==null?void 0:t.params)===null||r===void 0?void 0:r.apikey;a&&(this.accessToken=a),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:o=>[1e3,2e3,5e3,1e4][o-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(o,l)=>l(JSON.stringify(o)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new es(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){this.conn||(this.conn=new this.transport(this._endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e)))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Ie.connecting:return he.Connecting;case Ie.open:return he.Open;case Ie.closing:return he.Closing;default:return he.Closed}}isConnected(){return this.connectionState()===he.Open}channel(e,t={config:{}}){const s=new wt(`realtime:${e}`,t,this);return this.channels.push(s),s}push(e){const{topic:t,event:s,payload:r,ref:i}=e;let a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};if(this.log("push",`${t} ${s} (${i})`,r),this.isConnected())if(["broadcast","presence","postgres_changes"].includes(s)){if(this._throttle(a)())return"rate limited"}else a();else this.sendBuffer.push(a)}setAuth(e){this.accessToken=e,this.channels.forEach(t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(Y.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:lr}))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:s,event:r,payload:i,ref:a}=t;(a&&a===this.pendingHeartbeatRef||r===(i==null?void 0:i.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${s} ${r} ${a&&"("+a+")"||""}`,i),this.channels.filter(o=>o._isMember(s)).forEach(o=>o._trigger(r,i,a)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Y.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",r=new URLSearchParams(t);return`${e}${s}${r}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(cr,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}_throttle(e,t=this.eventsPerSecondLimitMs){return()=>this.inThrottle?!0:(e(),t>0&&(this.inThrottle=!0,setTimeout(()=>{this.inThrottle=!1},t)),!1)}}class $t extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function G(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class br extends $t{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Lt extends $t{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var yr=globalThis&&globalThis.__awaiter||function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(f){a(f)}}function l(u){try{c(s.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((s=s.apply(n,e||[])).next())})};const ss=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>qe(()=>Promise.resolve().then(()=>ze),void 0,import.meta.url).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},wr=()=>yr(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield qe(()=>Promise.resolve().then(()=>ze),void 0,import.meta.url)).Response:Response});var Te=globalThis&&globalThis.__awaiter||function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(f){a(f)}}function l(u){try{c(s.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((s=s.apply(n,e||[])).next())})};const nt=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),$r=(n,e)=>Te(void 0,void 0,void 0,function*(){const t=yield wr();n instanceof t?n.json().then(s=>{e(new br(nt(s),n.status||500))}).catch(s=>{e(new Lt(nt(s),s))}):e(new Lt(nt(n),n))}),kr=(n,e,t,s)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(s),Object.assign(Object.assign({},r),t))};function Xe(n,e,t,s,r,i){return Te(this,void 0,void 0,function*(){return new Promise((a,o)=>{n(t,kr(e,s,r,i)).then(l=>{if(!l.ok)throw l;return s!=null&&s.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>$r(l,o))})})}function ft(n,e,t,s){return Te(this,void 0,void 0,function*(){return Xe(n,"GET",e,t,s)})}function se(n,e,t,s,r){return Te(this,void 0,void 0,function*(){return Xe(n,"POST",e,s,r,t)})}function Tr(n,e,t,s,r){return Te(this,void 0,void 0,function*(){return Xe(n,"PUT",e,s,r,t)})}function rs(n,e,t,s,r){return Te(this,void 0,void 0,function*(){return Xe(n,"DELETE",e,s,r,t)})}var W=globalThis&&globalThis.__awaiter||function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(f){a(f)}}function l(u){try{c(s.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((s=s.apply(n,e||[])).next())})};const Sr={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Dt={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Er{constructor(e,t={},s,r){this.url=e,this.headers=t,this.bucketId=s,this.fetch=ss(r)}uploadOrUpdate(e,t,s,r){return W(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},Dt),r),o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",a.cacheControl)):(i=s,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType);const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),u=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:i,headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{}));return u.ok?{data:{path:l},error:null}:{data:null,error:yield u.json()}}catch(i){if(G(i))return{data:null,error:i};throw i}})}upload(e,t,s){return W(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,r){return W(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:Dt.upsert},r),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&s instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",s)):typeof FormData<"u"&&s instanceof FormData?(l=s,l.append("cacheControl",c.cacheControl)):(l=s,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const f=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:u});return f.ok?{data:{path:i},error:null}:{data:null,error:yield f.json()}}catch(l){if(G(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e){return W(this,void 0,void 0,function*(){try{let t=this._getFinalPath(e);const s=yield se(this.fetch,`${this.url}/object/upload/sign/${t}`,{},{headers:this.headers}),r=new URL(this.url+s.url),i=r.searchParams.get("token");if(!i)throw new $t("No token returned by API");return{data:{signedUrl:r.toString(),path:e,token:i},error:null}}catch(t){if(G(t))return{data:null,error:t};throw t}})}update(e,t,s){return W(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t){return W(this,void 0,void 0,function*(){try{return{data:yield se(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers}),error:null}}catch(s){if(G(s))return{data:null,error:s};throw s}})}copy(e,t){return W(this,void 0,void 0,function*(){try{return{data:{path:(yield se(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers})).Key},error:null}}catch(s){if(G(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,s){return W(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),i=yield se(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(r){if(G(r))return{data:null,error:r};throw r}})}createSignedUrls(e,t,s){return W(this,void 0,void 0,function*(){try{const r=yield se(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:r.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(r){if(G(r))return{data:null,error:r};throw r}})}download(e,t){return W(this,void 0,void 0,function*(){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=i?`?${i}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield ft(this.fetch,`${this.url}/${r}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(G(o))return{data:null,error:o};throw o}})}getPublicUrl(e,t){const s=this._getFinalPath(e),r=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&r.push(i);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&r.push(l);let c=r.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${s}${c}`)}}}remove(e){return W(this,void 0,void 0,function*(){try{return{data:yield rs(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(G(t))return{data:null,error:t};throw t}})}list(e,t,s){return W(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},Sr),t),{prefix:e||""});return{data:yield se(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},s),error:null}}catch(r){if(G(r))return{data:null,error:r};throw r}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Or="2.5.4",jr={"X-Client-Info":`storage-js/${Or}`};var pe=globalThis&&globalThis.__awaiter||function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(f){a(f)}}function l(u){try{c(s.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((s=s.apply(n,e||[])).next())})};class Cr{constructor(e,t={},s){this.url=e,this.headers=Object.assign(Object.assign({},jr),t),this.fetch=ss(s)}listBuckets(){return pe(this,void 0,void 0,function*(){try{return{data:yield ft(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(G(e))return{data:null,error:e};throw e}})}getBucket(e){return pe(this,void 0,void 0,function*(){try{return{data:yield ft(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(G(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return pe(this,void 0,void 0,function*(){try{return{data:yield se(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(G(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return pe(this,void 0,void 0,function*(){try{return{data:yield Tr(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(G(s))return{data:null,error:s};throw s}})}emptyBucket(e){return pe(this,void 0,void 0,function*(){try{return{data:yield se(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(G(t))return{data:null,error:t};throw t}})}deleteBucket(e){return pe(this,void 0,void 0,function*(){try{return{data:yield rs(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(G(t))return{data:null,error:t};throw t}})}}class Ar extends Cr{constructor(e,t={},s){super(e,t,s)}from(e){return new Er(this.url,this.headers,e,this.fetch)}}const Ir="2.38.2";let Ce="";typeof Deno<"u"?Ce="deno":typeof document<"u"?Ce="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ce="react-native":Ce="node";const Rr={"X-Client-Info":`supabase-js-${Ce}/${Ir}`};var xr=globalThis&&globalThis.__awaiter||function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(f){a(f)}}function l(u){try{c(s.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((s=s.apply(n,e||[])).next())})};const Pr=n=>{let e;return n?e=n:typeof fetch>"u"?e=bt:e=fetch,(...t)=>e(...t)},Lr=()=>typeof Headers>"u"?vt.Headers:Headers,Dr=(n,e,t)=>{const s=Pr(t),r=Lr();return(i,a)=>xr(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:n;let c=new r(a==null?void 0:a.headers);return c.has("apikey")||c.set("apikey",n),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),s(i,Object.assign(Object.assign({},a),{headers:c}))})};function Ur(n){return n.replace(/\/$/,"")}function Nr(n,e){const{db:t,auth:s,realtime:r,global:i}=n,{db:a,auth:o,realtime:l,global:c}=e;return{db:Object.assign(Object.assign({},a),t),auth:Object.assign(Object.assign({},o),s),realtime:Object.assign(Object.assign({},l),r),global:Object.assign(Object.assign({},c),i)}}function Fr(n){return Math.round(Date.now()/1e3)+n}function qr(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const Z=()=>typeof document<"u",le={tested:!1,writable:!1},xe=()=>{if(!Z())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(le.tested)return le.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),le.tested=!0,le.writable=!0}catch{le.tested=!0,le.writable=!1}return le.writable};function at(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((r,i)=>{e[i]=r})}catch{}return t.searchParams.forEach((s,r)=>{e[r]=s}),e}const is=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>qe(()=>Promise.resolve().then(()=>ze),void 0,import.meta.url).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},Mr=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",ce=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},He=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},ot=async(n,e)=>{await n.removeItem(e)};function zr(n){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",s,r,i,a,o,l,c,u=0;for(n=n.replace("-","+").replace("_","/");u<n.length;)a=e.indexOf(n.charAt(u++)),o=e.indexOf(n.charAt(u++)),l=e.indexOf(n.charAt(u++)),c=e.indexOf(n.charAt(u++)),s=a<<2|o>>4,r=(o&15)<<4|l>>2,i=(l&3)<<6|c,t=t+String.fromCharCode(s),l!=64&&r!=0&&(t=t+String.fromCharCode(r)),c!=64&&i!=0&&(t=t+String.fromCharCode(i));return t}class Qe{constructor(){this.promise=new Qe.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Qe.promiseConstructor=Promise;function Ut(n){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=n.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const s=t[1];return JSON.parse(zr(s))}async function Jr(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function Hr(n,e){return new Promise((s,r)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await n(i);if(!e(i,null,a)){s(a);return}}catch(a){if(!e(i,a)){r(a);return}}})()})}function Br(n){return("0"+n.toString(16)).substr(-2)}function ve(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let r="";for(let i=0;i<56;i++)r+=t.charAt(Math.floor(Math.random()*s));return r}return crypto.getRandomValues(e),Array.from(e,Br).join("")}async function Gr(n){const t=new TextEncoder().encode(n),s=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(s);return Array.from(r).map(i=>String.fromCharCode(i)).join("")}function Vr(n){return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function be(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await Gr(n);return Vr(t)}class kt extends Error{constructor(e,t){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t}}function x(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class Kr extends kt{constructor(e,t){super(e,t),this.name="AuthApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}function Wr(n){return x(n)&&n.name==="AuthApiError"}class ns extends kt{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Se extends kt{constructor(e,t,s){super(e),this.name=t,this.status=s}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class ye extends Se{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}}class lt extends Se{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500)}}class Be extends Se{constructor(e){super(e,"AuthInvalidCredentialsError",400)}}class Ge extends Se{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Nt extends Se{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class gt extends Se{constructor(e,t){super(e,"AuthRetryableFetchError",t)}}function Ft(n){return x(n)&&n.name==="AuthRetryableFetchError"}var Yr=globalThis&&globalThis.__rest||function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(t[s[r]]=n[s[r]]);return t};const Ae=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Xr=[502,503,504];async function qt(n){if(!Mr(n))throw new gt(Ae(n),0);if(Xr.includes(n.status))throw new gt(Ae(n),n.status);let e;try{e=await n.json()}catch(t){throw new ns(Ae(t),t)}throw new Kr(Ae(e),n.status||500)}const Qr=(n,e,t,s)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(s),Object.assign(Object.assign({},r),t))};async function P(n,e,t,s){var r;const i=Object.assign({},s==null?void 0:s.headers);s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const a=(r=s==null?void 0:s.query)!==null&&r!==void 0?r:{};s!=null&&s.redirectTo&&(a.redirect_to=s.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await Zr(n,e,t+o,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function Zr(n,e,t,s,r,i){const a=Qr(e,s,r,i);let o;try{o=await n(t,a)}catch(l){throw console.error(l),new gt(Ae(l),0)}if(o.ok||await qt(o),s!=null&&s.noResolveJson)return o;try{return await o.json()}catch(l){await qt(l)}}function te(n){var e;let t=null;ri(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=Fr(n.expires_in)));const s=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:s},error:null}}function re(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function ei(n){return{data:n,error:null}}function ti(n){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:r,verification_type:i}=n,a=Yr(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:s,redirect_to:r,verification_type:i},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function si(n){return n}function ri(n){return n.access_token&&n.refresh_token&&n.expires_in}var ii=globalThis&&globalThis.__rest||function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(t[s[r]]=n[s[r]]);return t};class ni{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=is(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await P(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(x(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await P(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:re})}catch(s){if(x(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=ii(e,["options"]),r=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(r.new_email=s==null?void 0:s.newEmail,delete r.newEmail),await P(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:ti,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(x(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await P(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:re})}catch(t){if(x(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,r,i,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await P(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(i=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:si});if(u.error)throw u.error;const f=await u.json(),d=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,h=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return h.length>0&&(h.forEach(g=>{const v=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(g.split(";")[1].split("=")[1]);c[`${_}Page`]=v}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(x(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){try{return await P(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:re})}catch(t){if(x(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await P(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:re})}catch(s){if(x(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){try{return await P(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:re})}catch(s){if(x(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){try{const{data:t,error:s}=await P(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:t,error:s}}catch(t){if(x(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await P(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(x(t))return{data:null,error:t};throw t}}}const as="2.57.0",ai="http://localhost:9999",oi="supabase.auth.token",li={"X-Client-Info":`gotrue-js/${as}`},Mt=10,ci={getItem:n=>xe()?globalThis.localStorage.getItem(n):null,setItem:(n,e)=>{xe()&&globalThis.localStorage.setItem(n,e)},removeItem:n=>{xe()&&globalThis.localStorage.removeItem(n)}};function zt(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function ui(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}globalThis&&xe()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug");class hi extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}ui();const di={url:ai,storageKey:oi,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:li,flowType:"implicit",debug:!1},je=30*1e3,Jt=3;async function fi(n,e,t){return await t()}class Le{constructor(e){var t;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Le.nextInstanceID,Le.nextInstanceID+=1,this.instanceID>0&&Z()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},di),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new ni({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=is(s.fetch),this.lock=s.lock||fi,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:xe()?this.storage=ci:(this.memoryStorage={},this.storage=zt(this.memoryStorage)):(this.memoryStorage={},this.storage=zt(this.memoryStorage)),Z()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(r){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",r)}(t=this.broadcastChannel)===null||t===void 0||t.addEventListener("message",async r=>{this._debug("received broadcast notification from other tab or client",r),await this._notifyAllSubscribers(r.data.event,r.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${as}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const e=Z()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:t,error:s}=await this._getSessionFromURL(e);if(s)return this._debug("#_initialize()","error detecting session from URL",s),await this._removeSession(),{error:s};const{session:r,redirectType:i}=t;return this._debug("#_initialize()","detected session in URL",r,"redirect type",i),await this._saveSession(r),setTimeout(async()=>{i==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",r):await this._notifyAllSubscribers("SIGNED_IN",r)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return x(e)?{error:e}:{error:new ns("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signUp(e){var t,s,r;try{await this._removeSession();let i;if("email"in e){const{email:u,password:f,options:d}=e;let h=null,g=null;if(this.flowType==="pkce"){const v=ve();await ce(this.storage,`${this.storageKey}-code-verifier`,v),h=await be(v),g=v===h?"plain":"s256"}i=await P(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:u,password:f,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:h,code_challenge_method:g},xform:te})}else if("phone"in e){const{phone:u,password:f,options:d}=e;i=await P(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(s=d==null?void 0:d.data)!==null&&s!==void 0?s:{},channel:(r=d==null?void 0:d.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:te})}else throw new Be("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(x(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{await this._removeSession();let t;if("email"in e){const{email:i,password:a,options:o}=e;t=await P(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:te})}else if("phone"in e){const{phone:i,password:a,options:o}=e;t=await P(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:te})}else throw new Be("You must provide either an email or phone number and a password");const{data:s,error:r}=t;return r?{data:{user:null,session:null},error:r}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new lt}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:{user:s.user,session:s.session},error:r})}catch(t){if(x(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,r,i;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await He(this.storage,`${this.storageKey}-code-verifier`),{data:s,error:r}=await P(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:t},xform:te});return await ot(this.storage,`${this.storageKey}-code-verifier`),r?{data:{user:null,session:null},error:r}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new lt}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:s,error:r})}async signInWithIdToken(e){await this._removeSession();try{const{options:t,provider:s,token:r,access_token:i,nonce:a}=e,o=await P(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:te}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new lt}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(t){if(x(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,r,i,a;try{if(await this._removeSession(),"email"in e){const{email:o,options:l}=e;let c=null,u=null;if(this.flowType==="pkce"){const d=ve();await ce(this.storage,`${this.storageKey}-code-verifier`,d),c=await be(d),u=d===c?"plain":"s256"}const{error:f}=await P(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in e){const{phone:o,options:l}=e,{data:c,error:u}=await P(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Be("You must provide either an email or phone number.")}catch(o){if(x(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,s;try{e.type!=="email_change"&&e.type!=="phone_change"&&await this._removeSession();let r,i;"options"in e&&(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:a,error:o}=await P(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:r,xform:te});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(r){if(x(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var t,s,r;try{await this._removeSession();let i=null,a=null;if(this.flowType==="pkce"){const o=ve();await ce(this.storage,`${this.storageKey}-code-verifier`,o),i=await be(o),a=o===i?"plain":"s256"}return await P(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:ei})}catch(i){if(x(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new ye;const{error:r}=await P(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(x(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{e.type!="email_change"&&e.type!="phone_change"&&await this._removeSession();const t=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:i}=e,{error:a}=await P(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:s,type:r,options:i}=e,{data:a,error:o}=await P(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new Be("You must provide either an email or phone number and a type")}catch(t){if(x(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await He(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s)return{data:{session:e},error:null};const{session:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await P(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:re}):await this._useSession(async t=>{var s,r;const{data:i,error:a}=t;if(a)throw a;return await P(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(r=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:void 0,xform:re})})}catch(t){if(x(t))return{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:r,error:i}=s;if(i)throw i;if(!r.session)throw new ye;const a=r.session;let o=null,l=null;if(this.flowType==="pkce"&&e.email!=null){const f=ve();await ce(this.storage,`${this.storageKey}-code-verifier`,f),o=await be(f),l=f===o?"plain":"s256"}const{data:c,error:u}=await P(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:re});if(u)throw u;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(s){if(x(s))return{data:{user:null},error:s};throw s}}_decodeJWT(e){return Ut(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ye;const t=Date.now()/1e3;let s=t,r=!0,i=null;const a=Ut(e.access_token);if(a.exp&&(s=a.exp,r=s<=t),r){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(x(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(s=a.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new ye;const{session:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(x(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e){try{if(!Z())throw new Ge("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new Ge("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new Nt("Not a valid PKCE flow url.");const t=at(window.location.href);if(e){if(!t.code)throw new Nt("No code detected.");const{data:$,error:q}=await this._exchangeCodeForSession(t.code);if(q)throw q;const I=new URL(window.location.href);return I.searchParams.delete("code"),window.history.replaceState(window.history.state,"",I.toString()),{data:{session:$.session,redirectType:null},error:null}}if(t.error||t.error_description||t.error_code)throw new Ge(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});const{provider_token:s,provider_refresh_token:r,access_token:i,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=t;if(!i||!o||!a||!c)throw new Ge("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(o);let d=u+f;l&&(d=parseInt(l));const h=d-u;h*1e3<=je&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${f}s`);const g=d-f;u-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,d,u):u-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",g,d,u);const{data:v,error:_}=await this._getUser(i);if(_)throw _;const p={provider_token:s,provider_refresh_token:r,access_token:i,expires_in:f,expires_at:d,refresh_token:a,token_type:c,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:p,redirectType:t.type},error:null}}catch(t){if(x(t))return{data:{session:null,redirectType:null},error:t};throw t}}_isImplicitGrantFlow(){const e=at(window.location.href);return!!(Z()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=at(window.location.href),t=await He(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:r,error:i}=t;if(i)return{error:i};const a=(s=r.session)===null||s===void 0?void 0:s.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(Wr(o)&&(o.status===404||o.status===401)))return{error:o}}return e!=="others"&&(await this._removeSession(),await ot(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){const t=qr(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,r;try{const{data:{session:i},error:a}=t;if(a)throw a;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let s=null,r=null;if(this.flowType==="pkce"){const i=ve();await ce(this.storage,`${this.storageKey}-code-verifier`,i),s=await be(i),r=i===s?"plain":"s256"}try{return await P(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(x(i))return{data:null,error:i};throw i}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await Hr(async r=>(await Jr(r*200),this._debug(t,"refreshing attempt",r),await P(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:te})),(r,i,a)=>a&&a.error&&Ft(a.error)&&Date.now()+(r+1)*200-s<je)}catch(s){if(this._debug(t,"error",s),x(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),Z()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=await He(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s)){this._debug(t,"session is not valid"),s!==null&&await this._removeSession();return}const r=Math.round(Date.now()/1e3),i=((e=s.expires_at)!==null&&e!==void 0?e:1/0)<r+Mt;if(this._debug(t,`session has${i?"":" not"} expired with margin of ${Mt}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),Ft(a)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(t,"error",s),console.error(s);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new ye;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Qe;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new ye;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(r,"error",i),x(i)){const a={session:null,error:i};return(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){i.push(l)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),await this._persistSession(e)}_persistSession(e){return this._debug("#_persistSession()",e),ce(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await ot(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Z()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),je);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((s.expires_at*1e3-e)/je);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${je}ms, refresh threshold is ${Jt} ticks`),r<=Jt&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof hi)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Z()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t){const s=[`provider=${encodeURIComponent(e)}`];if(t!=null&&t.redirectTo&&s.push(`redirect_to=${encodeURIComponent(t.redirectTo)}`),t!=null&&t.scopes&&s.push(`scopes=${encodeURIComponent(t.scopes)}`),this.flowType==="pkce"){const r=ve();await ce(this.storage,`${this.storageKey}-code-verifier`,r);const i=await be(r),a=r===i?"plain":"s256";this._debug("PKCE","code verifier",`${r.substring(0,5)}...`,"code challenge",i,"method",a);const o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(o.toString())}if(t!=null&&t.queryParams){const r=new URLSearchParams(t.queryParams);s.push(r.toString())}return`${this.url}/authorize?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:r,error:i}=t;return i?{data:null,error:i}:await P(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(x(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,r;const{data:i,error:a}=t;if(a)return{data:null,error:a};const{data:o,error:l}=await P(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return l?{data:null,error:l}:(!((r=o==null?void 0:o.totp)===null||r===void 0)&&r.qr_code&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})})}catch(t){if(x(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:r,error:i}=t;if(i)return{data:null,error:i};const{data:a,error:o}=await P(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(t){if(x(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:r,error:i}=t;return i?{data:null,error:i}:await P(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(x(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(e==null?void 0:e.factors)||[],r=s.filter(i=>i.factor_type==="totp"&&i.status==="verified");return{data:{all:s,totp:r},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:r},error:i}=e;if(i)return{data:null,error:i};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const a=this._decodeJWT(r.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((s=(t=r.user.factors)===null||t===void 0?void 0:t.filter(f=>f.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(l="aal2");const u=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}}Le.nextInstanceID=0;class gi extends Le{constructor(e){super(e)}}var mi=globalThis&&globalThis.__awaiter||function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(f){a(f)}}function l(u){try{c(s.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((s=s.apply(n,e||[])).next())})};const _i={headers:Rr},pi={schema:"public"},vi={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},bi={};class yi{constructor(e,t,s){var r,i,a,o,l,c,u,f;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const d=Ur(e);this.realtimeUrl=`${d}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${d}/auth/v1`,this.storageUrl=`${d}/storage/v1`,this.functionsUrl=`${d}/functions/v1`;const h=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,g={db:pi,realtime:bi,auth:Object.assign(Object.assign({},vi),{storageKey:h}),global:_i},v=Nr(s??{},g);this.storageKey=(i=(r=v.auth)===null||r===void 0?void 0:r.storageKey)!==null&&i!==void 0?i:"",this.headers=(o=(a=v.global)===null||a===void 0?void 0:a.headers)!==null&&o!==void 0?o:{},this.auth=this._initSupabaseAuthClient((l=v.auth)!==null&&l!==void 0?l:{},this.headers,(c=v.global)===null||c===void 0?void 0:c.fetch),this.fetch=Dr(t,this._getAccessToken.bind(this),(u=v.global)===null||u===void 0?void 0:u.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},v.realtime)),this.rest=new yt(`${d}/rest/v1`,{headers:this.headers,schema:(f=v.db)===null||f===void 0?void 0:f.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new Rs(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Ar(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return mi(this,void 0,void 0,function*(){const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,storageKey:i,flowType:a,debug:o},l,c){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new gi({url:this.authUrl,headers:Object.assign(Object.assign({},u),l),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,flowType:a,debug:o,fetch:c})}_initRealtimeClient(e){return new vr(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?(this.realtime.setAuth(s??null),this.changedAccessToken=s):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const wi=(n,e,t)=>new yi(n,e,t);function $i(n){let e,t,s,r=n[4]?"*":"",i,a,o,l,c,u,f,d,h,g,v=!n[0]&&Ht(n);return{c(){e=k("label"),t=H(n[2]),s=S(),i=H(r),l=S(),c=k("div"),u=k("h3"),v&&v.c(),f=S(),d=k("textarea"),this.h()},l(_){e=T(_,"LABEL",{for:!0,class:!0});var p=R(e);t=B(p,n[2]),s=E(p),i=B(p,r),p.forEach(m),l=E(_),c=T(_,"DIV",{class:!0});var $=R(c);u=T($,"H3",{class:!0});var q=R(u);v&&v.l(q),q.forEach(m),$.forEach(m),f=E(_),d=T(_,"TEXTAREA",{id:!0,rows:!0,name:!0,class:!0}),R(d).forEach(m),this.h()},h(){b(e,"for",a=n[2].toLowerCase()),b(e,"class",o=(n[0]?"font-bold text-surface-on -top-1 -translate-y-full left-0":"font-normal left-3 top-2.5")+" block group-hover:font-bold text-surface-on group-hover:text-surface-on absolute group-hover:-top-1 duration-[400ms] ease-in-out group-hover:-translate-y-full group-hover:left-0 transition-all"),b(u,"class","absolute not-prose pointer-events-none -left-1/2 invisible group-hover:visible group-hover:left-3 group-hover:right-auto text-left top-0 transition-all duration-[400ms] ease-out text-surface-on"),b(c,"class","overflow-hidden w-full h-full absolute pointer-events-none"),b(d,"id","message"),d.required=!0,b(d,"rows","4"),b(d,"name","message"),b(d,"class","w-full h-full px-3 py-3 leading-tight text-surface-on bg-surface/50 border border-primary rounded focus:shadow-glow focus:shadow-tertiary/20 focus:outline-none appearance-none")},m(_,p){y(_,e,p),C(e,t),C(e,s),C(e,i),y(_,l,p),y(_,c,p),C(c,u),v&&v.m(u,null),y(_,f,p),y(_,d,p),Ke(d,n[0]),h||(g=We(d,"input",n[6]),h=!0)},p(_,p){p&4&&ee(t,_[2]),p&16&&r!==(r=_[4]?"*":"")&&ee(i,r),p&4&&a!==(a=_[2].toLowerCase())&&b(e,"for",a),p&1&&o!==(o=(_[0]?"font-bold text-surface-on -top-1 -translate-y-full left-0":"font-normal left-3 top-2.5")+" block group-hover:font-bold text-surface-on group-hover:text-surface-on absolute group-hover:-top-1 duration-[400ms] ease-in-out group-hover:-translate-y-full group-hover:left-0 transition-all")&&b(e,"class",o),_[0]?v&&(v.d(1),v=null):v?v.p(_,p):(v=Ht(_),v.c(),v.m(u,null)),p&1&&Ke(d,_[0])},d(_){_&&(m(e),m(l),m(c),m(f),m(d)),v&&v.d(),h=!1,g()}}}function ki(n){let e,t,s,r=n[4]?"*":"",i,a,o,l,c,u,f,d,h,g,v,_=!n[0]&&Bt(n);return{c(){e=k("label"),t=H(n[2]),s=S(),i=H(r),l=S(),c=k("div"),u=k("h3"),_&&_.c(),f=S(),d=k("input"),this.h()},l(p){e=T(p,"LABEL",{for:!0,class:!0});var $=R(e);t=B($,n[2]),s=E($),i=B($,r),$.forEach(m),l=E(p),c=T(p,"DIV",{class:!0});var q=R(c);u=T(q,"H3",{class:!0});var I=R(u);_&&_.l(I),I.forEach(m),q.forEach(m),f=E(p),d=T(p,"INPUT",{name:!0,class:!0}),this.h()},h(){b(e,"for",a=n[2].toLowerCase()),b(e,"class",o=(n[0]?"font-bold text-surface-on -top-1/2 -translate-y-5 left-0":"font-normal left-3 top-1/2")+" block group-hover:font-bold text-surface-on group-hover:text-surface-on absolute -translate-y-1/2 duration-[400ms] ease-in-out group-hover:left-0 group-hover:-top-1/2 group-hover:-translate-y-5 transition-all"),b(u,"class","absolute invisible text-left transition-all duration-[400ms] ease-out -translate-y-1/2 pointer-events-none -left-1/2 group-hover:visible group-hover:left-3 group-hover:right-auto top-1/2 text-surface-on"),b(c,"class","absolute w-full h-full overflow-hidden pointer-events-none"),d.required=n[4],b(d,"name",h=n[2].toLowerCase()),b(d,"class","w-full h-fit px-3 py-3 leading-tight text-surface-on bg-surface/50 border border-primary rounded focus:shadow-glow focus:shadow-tertiary/20 focus:outline-none appearance-none")},m(p,$){y(p,e,$),C(e,t),C(e,s),C(e,i),y(p,l,$),y(p,c,$),C(c,u),_&&_.m(u,null),y(p,f,$),y(p,d,$),Ke(d,n[0]),g||(v=We(d,"input",n[5]),g=!0)},p(p,$){$&4&&ee(t,p[2]),$&16&&r!==(r=p[4]?"*":"")&&ee(i,r),$&4&&a!==(a=p[2].toLowerCase())&&b(e,"for",a),$&1&&o!==(o=(p[0]?"font-bold text-surface-on -top-1/2 -translate-y-5 left-0":"font-normal left-3 top-1/2")+" block group-hover:font-bold text-surface-on group-hover:text-surface-on absolute -translate-y-1/2 duration-[400ms] ease-in-out group-hover:left-0 group-hover:-top-1/2 group-hover:-translate-y-5 transition-all")&&b(e,"class",o),p[0]?_&&(_.d(1),_=null):_?_.p(p,$):(_=Bt(p),_.c(),_.m(u,null)),$&16&&(d.required=p[4]),$&4&&h!==(h=p[2].toLowerCase())&&b(d,"name",h),$&1&&d.value!==p[0]&&Ke(d,p[0])},d(p){p&&(m(e),m(l),m(c),m(f),m(d)),_&&_.d(),g=!1,v()}}}function Ht(n){let e;return{c(){e=H(n[1])},l(t){e=B(t,n[1])},m(t,s){y(t,e,s)},p(t,s){s&2&&ee(e,t[1])},d(t){t&&m(e)}}}function Bt(n){let e;return{c(){e=H(n[1])},l(t){e=B(t,n[1])},m(t,s){y(t,e,s)},p(t,s){s&2&&ee(e,t[1])},d(t){t&&m(e)}}}function Ti(n){let e,t;function s(a,o){return a[3]?$i:ki}let r=s(n),i=r(n);return{c(){e=k("div"),i.c(),this.h()},l(a){e=T(a,"DIV",{class:!0});var o=R(e);i.l(o),o.forEach(m),this.h()},h(){b(e,"class",t="relative mb-8 h-fit w-full group overflow-visible mx-1.5 "+(n[3]?"h-full":""))},m(a,o){y(a,e,o),i.m(e,null)},p(a,[o]){r===(r=s(a))&&i?i.p(a,o):(i.d(1),i=r(a),i&&(i.c(),i.m(e,null))),o&8&&t!==(t="relative mb-8 h-fit w-full group overflow-visible mx-1.5 "+(a[3]?"h-full":""))&&b(e,"class",t)},i:fe,o:fe,d(a){a&&m(e),i.d()}}}function Si(n,e,t){let{value:s}=e,{placeholder:r}=e,{label:i}=e,{textArea:a=!1}=e,{required:o=!1}=e;function l(){s=this.value,t(0,s)}function c(){s=this.value,t(0,s)}return n.$$set=u=>{"value"in u&&t(0,s=u.value),"placeholder"in u&&t(1,r=u.placeholder),"label"in u&&t(2,i=u.label),"textArea"in u&&t(3,a=u.textArea),"required"in u&&t(4,o=u.required)},[s,r,i,a,o,l,c]}class ct extends me{constructor(e){super(),_e(this,e,Si,Ti,ge,{value:0,placeholder:1,label:2,textArea:3,required:4})}}function Ei(n){let e;return{c(){e=H("Send")},l(t){e=B(t,"Send")},m(t,s){y(t,e,s)},d(t){t&&m(e)}}}function Oi(n){let e,t,s,r,i,a,o,l,c,u,f,d,h,g='<h2 class="title-medium m-0 sm:m-0">Your message has been sent. Thank you for contacting us!</h2>',v,_,p;function $(w){n[4](w)}let q={label:"Name",placeholder:"Elon Gates",required:!0};n[0]!==void 0&&(q.value=n[0]),t=new ct({props:q}),et.push(()=>st(t,"value",$));function I(w){n[5](w)}let J={label:"Email",placeholder:"j.lewis@futi.no",required:!0};n[1]!==void 0&&(J.value=n[1]),i=new ct({props:J}),et.push(()=>st(i,"value",I));function L(w){n[6](w)}let Je={label:"Your Message",placeholder:"I want to ask about",required:!0,textArea:!0};return n[2]!==void 0&&(Je.value=n[2]),l=new ct({props:Je}),et.push(()=>st(l,"value",L)),f=new oe({props:{type:"submit",id:"submit",class:"w-full",$$slots:{default:[Ei]},$$scope:{ctx:n}}}),{c(){e=k("form"),D(t.$$.fragment),r=S(),D(i.$$.fragment),o=S(),D(l.$$.fragment),u=S(),D(f.$$.fragment),d=S(),h=k("div"),h.innerHTML=g,this.h()},l(w){e=T(w,"FORM",{id:!0,class:!0});var O=R(e);U(t.$$.fragment,O),r=E(O),U(i.$$.fragment,O),o=E(O),U(l.$$.fragment,O),u=E(O),U(f.$$.fragment,O),d=E(O),h=T(O,"DIV",{class:!0,"data-svelte-h":!0}),Q(h)!=="svelte-19q5gjd"&&(h.innerHTML=g),O.forEach(m),this.h()},h(){b(h,"class","mx-1.5 text-left self-start"),ls(h,"hidden",!ji),b(e,"id","contactform"),b(e,"class","flex flex-col gap-8 text-left items-center overflow-x-clip h-full")},m(w,O){y(w,e,O),N(t,e,null),C(e,r),N(i,e,null),C(e,o),N(l,e,null),C(e,u),N(f,e,null),C(e,d),C(e,h),v=!0,_||(p=We(e,"submit",cs(n[3])),_=!0)},p(w,[O]){const M={};!s&&O&1&&(s=!0,M.value=w[0],tt(()=>s=!1)),t.$set(M);const X={};!a&&O&2&&(a=!0,X.value=w[1],tt(()=>a=!1)),i.$set(X);const Ee={};!c&&O&4&&(c=!0,Ee.value=w[2],tt(()=>c=!1)),l.$set(Ee);const Oe={};O&512&&(Oe.$$scope={dirty:O,ctx:w}),f.$set(Oe)},i(w){v||(j(t.$$.fragment,w),j(i.$$.fragment,w),j(l.$$.fragment,w),j(f.$$.fragment,w),v=!0)},o(w){A(t.$$.fragment,w),A(i.$$.fragment,w),A(l.$$.fragment,w),A(f.$$.fragment,w),v=!1},d(w){w&&m(e),F(t),F(i),F(l),F(f),_=!1,p()}}}let ji=!1;function Ci(n,e,t){var s=this&&this.__awaiter||function(f,d,h,g){function v(_){return _ instanceof h?_:new h(function(p){p(_)})}return new(h||(h=Promise))(function(_,p){function $(J){try{I(g.next(J))}catch(L){p(L)}}function q(J){try{I(g.throw(J))}catch(L){p(L)}}function I(J){J.done?_(J.value):v(J.value).then($,q)}I((g=g.apply(f,d||[])).next())})};wi("https://qnzxoapdhdycrblbeovn.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFuenhvYXBkaGR5Y3JibGJlb3ZuIiwicm9sZSI6ImFub24iLCJpYXQiOjE2OTMyNzc4NDQsImV4cCI6MjAwODg1Mzg0NH0.oXm7-RMRSzKw0blIJ99daqwW7vz93Tj2iadXg1m6EEs");let r="",i="",a="";function o(f){return s(this,void 0,void 0,function*(){let d=new FormData(f.target);console.log(d)})}function l(f){r=f,t(0,r)}function c(f){i=f,t(1,i)}function u(f){a=f,t(2,a)}return[r,i,a,o,l,c,u]}class Ai extends me{constructor(e){super(),_e(this,e,Ci,Oi,ge,{})}}function Gt(n,e,t){const s=n.slice();return s[3]=e[t].day,s[4]=e[t].time,s}function Vt(n,e,t){const s=n.slice();return s[7]=e[t].price,s[8]=e[t].label,s}function Kt(n,e,t){const s=n.slice();return s[11]=e[t].title,s[12]=e[t].body,s[13]=e[t].img,s}function Ii(n){let e;return{c(){e=H("CLASS SCHEDULE")},l(t){e=B(t,"CLASS SCHEDULE")},m(t,s){y(t,e,s)},d(t){t&&m(e)}}}function Ri(n){let e;return{c(){e=H("CONTACT US")},l(t){e=B(t,"CONTACT US")},m(t,s){y(t,e,s)},d(t){t&&m(e)}}}function xi(n){let e,t="OUR MISSION",s,r,i=`Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
        tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim
        veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea
        commodo consequat.`,a,o,l,c,u,f;return l=new oe({props:{class:"w-full",padding:"px-4 md:px-8 py-4",href:"#classes",$$slots:{default:[Ii]},$$scope:{ctx:n}}}),u=new oe({props:{class:"w-full",padding:"px-4 md:px-8 py-4",href:"/contact",$$slots:{default:[Ri]},$$scope:{ctx:n}}}),{c(){e=k("h2"),e.textContent=t,s=S(),r=k("p"),r.textContent=i,a=S(),o=k("div"),D(l.$$.fragment),c=S(),D(u.$$.fragment),this.h()},l(d){e=T(d,"H2",{class:!0,style:!0,"data-svelte-h":!0}),Q(e)!=="svelte-jt66xt"&&(e.textContent=t),s=E(d),r=T(d,"P",{class:!0,style:!0,"data-svelte-h":!0}),Q(r)!=="svelte-5zkle4"&&(r.textContent=i),a=E(d),o=T(d,"DIV",{class:!0});var h=R(o);U(l.$$.fragment,h),c=E(h),U(u.$$.fragment,h),h.forEach(m),this.h()},h(){b(e,"class",""),K(e,"margin","0"),b(r,"class","max-w-3xl"),K(r,"margin","0"),b(o,"class","grid grid-cols-2 gap-4 md:gap-6 place-items-center w-fit pt-6")},m(d,h){y(d,e,h),y(d,s,h),y(d,r,h),y(d,a,h),y(d,o,h),N(l,o,null),C(o,c),N(u,o,null),f=!0},p(d,h){const g={};h&65536&&(g.$$scope={dirty:h,ctx:d}),l.$set(g);const v={};h&65536&&(v.$$scope={dirty:h,ctx:d}),u.$set(v)},i(d){f||(j(l.$$.fragment,d),j(u.$$.fragment,d),f=!0)},o(d){A(l.$$.fragment,d),A(u.$$.fragment,d),f=!1},d(d){d&&(m(e),m(s),m(r),m(a),m(o)),F(l),F(u)}}}function Pi(n){let e,t;return e=new Me({props:{class:"text-center flex flex-col place-items-center gap-6",sizes:"max-w-none",$$slots:{default:[xi]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment)},l(s){U(e.$$.fragment,s)},m(s,r){N(e,s,r),t=!0},p(s,r){const i={};r&65536&&(i.$$scope={dirty:r,ctx:s}),e.$set(i)},i(s){t||(j(e.$$.fragment,s),t=!0)},o(s){A(e.$$.fragment,s),t=!1},d(s){F(e,s)}}}function Wt(n){let e,t,s,r,i,a,o=n[11]+"",l,c,u,f=n[12]+"",d,h;return{c(){e=k("div"),t=k("img"),r=S(),i=k("div"),a=k("h2"),l=H(o),c=S(),u=k("p"),d=H(f),h=S(),this.h()},l(g){e=T(g,"DIV",{class:!0});var v=R(e);t=T(v,"IMG",{src:!0,alt:!0,class:!0}),v.forEach(m),r=E(g),i=T(g,"DIV",{class:!0});var _=R(i);a=T(_,"H2",{class:!0,style:!0});var p=R(a);l=B(p,o),p.forEach(m),c=E(_),u=T(_,"P",{style:!0});var $=R(u);d=B($,f),$.forEach(m),h=E(_),_.forEach(m),this.h()},h(){de(t.src,s=n[13])||b(t,"src",s),b(t,"alt",""),b(t,"class","not-prose w-full h-full aspect-video object-cover object-center"),b(e,"class","w-full max-w-lg md:max-w-none mx-auto h-64 sm:h-96 flex place-items-center"),b(a,"class",""),K(a,"margin","0"),K(u,"margin","0"),b(i,"class","flex max-w-xl flex-col gap-4 mb-12 sm:mb-16 md:mb-0")},m(g,v){y(g,e,v),C(e,t),y(g,r,v),y(g,i,v),C(i,a),C(a,l),C(i,c),C(i,u),C(u,d),C(i,h)},p:fe,d(g){g&&(m(e),m(r),m(i))}}}function Li(n){let e,t=ie(n[0]),s=[];for(let r=0;r<t.length;r+=1)s[r]=Wt(Kt(n,t,r));return{c(){for(let r=0;r<s.length;r+=1)s[r].c();e=ke()},l(r){for(let i=0;i<s.length;i+=1)s[i].l(r);e=ke()},m(r,i){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(r,i);y(r,e,i)},p(r,i){if(i&1){t=ie(r[0]);let a;for(a=0;a<t.length;a+=1){const o=Kt(r,t,a);s[a]?s[a].p(o,i):(s[a]=Wt(o),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(r){r&&m(e),Ve(s,r)}}}function Di(n){let e,t;return e=new Me({props:{class:"text-center md:text-left items-start flex flex-col md:grid md:grid-cols-2 md:place-items-center gap-x-12 gap-y-4 sm:gap-y-4 md:gap-y-12",sizes:"max-w-7xl",$$slots:{default:[Li]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment)},l(s){U(e.$$.fragment,s)},m(s,r){N(e,s,r),t=!0},p(s,r){const i={};r&65536&&(i.$$scope={dirty:r,ctx:s}),e.$set(i)},i(s){t||(j(e.$$.fragment,s),t=!0)},o(s){A(e.$$.fragment,s),t=!1},d(s){F(e,s)}}}function Yt(n){let e,t=n[7]+"",s,r,i,a=n[8]+"",o;return{c(){e=k("h4"),s=H(t),r=S(),i=k("h4"),o=H(a),this.h()},l(l){e=T(l,"H4",{class:!0,style:!0});var c=R(e);s=B(c,t),c.forEach(m),r=E(l),i=T(l,"H4",{class:!0,style:!0});var u=R(i);o=B(u,a),u.forEach(m),this.h()},h(){b(e,"class","text-left justify-self-start"),K(e,"margin","0"),b(i,"class","text-right whitespace-nowrap justify-self-end"),K(i,"margin","0")},m(l,c){y(l,e,c),C(e,s),y(l,r,c),y(l,i,c),C(i,o)},p:fe,d(l){l&&(m(e),m(r),m(i))}}}function Xt(n){let e,t=n[3]+"",s,r,i,a=n[4]+"",o;return{c(){e=k("h4"),s=H(t),r=S(),i=k("h4"),o=H(a),this.h()},l(l){e=T(l,"H4",{class:!0,style:!0});var c=R(e);s=B(c,t),c.forEach(m),r=E(l),i=T(l,"H4",{class:!0,style:!0});var u=R(i);o=B(u,a),u.forEach(m),this.h()},h(){b(e,"class","text-left justify-self-start"),K(e,"margin","0"),b(i,"class","text-right whitespace-nowrap justify-self-end"),K(i,"margin","0")},m(l,c){y(l,e,c),C(e,s),y(l,r,c),y(l,i,c),C(i,o)},p:fe,d(l){l&&(m(e),m(r),m(i))}}}function Ui(n){let e;return{c(){e=H("REGISTER")},l(t){e=B(t,"REGISTER")},m(t,s){y(t,e,s)},d(t){t&&m(e)}}}function Ni(n){let e,t;return e=new oe({props:{class:"col-span-2 w-full",$$slots:{default:[Ui]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment)},l(s){U(e.$$.fragment,s)},m(s,r){N(e,s,r),t=!0},p(s,r){const i={};r&65536&&(i.$$scope={dirty:r,ctx:s}),e.$set(i)},i(s){t||(j(e.$$.fragment,s),t=!0)},o(s){A(e.$$.fragment,s),t=!1},d(s){F(e,s)}}}function Fi(n){let e,t,s,r,i,a,o,l,c,u=ie(n[1]),f=[];for(let g=0;g<u.length;g+=1)f[g]=Yt(Vt(n,u,g));let d=ie(n[2]),h=[];for(let g=0;g<d.length;g+=1)h[g]=Xt(Gt(n,d,g));return l=new Ye({props:{size:"lg",class:"w-full col-span-2 self-end",$$slots:{default:[Ni]},$$scope:{ctx:n}}}),{c(){e=k("div");for(let g=0;g<f.length;g+=1)f[g].c();t=S(),s=k("div"),r=S();for(let g=0;g<h.length;g+=1)h[g].c();i=S(),a=k("div"),o=S(),D(l.$$.fragment),this.h()},l(g){e=T(g,"DIV",{class:!0});var v=R(e);for(let _=0;_<f.length;_+=1)f[_].l(v);t=E(v),s=T(v,"DIV",{class:!0}),R(s).forEach(m),r=E(v);for(let _=0;_<h.length;_+=1)h[_].l(v);i=E(v),a=T(v,"DIV",{class:!0}),R(a).forEach(m),o=E(v),U(l.$$.fragment,v),v.forEach(m),this.h()},h(){b(s,"class","pt-4 col-span-2"),b(a,"class","pt-6 col-span-2"),b(e,"class","grid grid-cols-2 gap-y-2 w-full")},m(g,v){y(g,e,v);for(let _=0;_<f.length;_+=1)f[_]&&f[_].m(e,null);C(e,t),C(e,s),C(e,r);for(let _=0;_<h.length;_+=1)h[_]&&h[_].m(e,null);C(e,i),C(e,a),C(e,o),N(l,e,null),c=!0},p(g,v){if(v&2){u=ie(g[1]);let p;for(p=0;p<u.length;p+=1){const $=Vt(g,u,p);f[p]?f[p].p($,v):(f[p]=Yt($),f[p].c(),f[p].m(e,t))}for(;p<f.length;p+=1)f[p].d(1);f.length=u.length}if(v&4){d=ie(g[2]);let p;for(p=0;p<d.length;p+=1){const $=Gt(g,d,p);h[p]?h[p].p($,v):(h[p]=Xt($),h[p].c(),h[p].m(e,i))}for(;p<h.length;p+=1)h[p].d(1);h.length=d.length}const _={};v&65536&&(_.$$scope={dirty:v,ctx:g}),l.$set(_)},i(g){c||(j(l.$$.fragment,g),c=!0)},o(g){A(l.$$.fragment,g),c=!1},d(g){g&&m(e),Ve(f,g),Ve(h,g),F(l)}}}function qi(n){let e,t="ADULT CLASSES",s,r,i,a,o,l;return o=new Ye({props:{size:"sm",class:"w-full",$$slots:{default:[Fi]},$$scope:{ctx:n}}}),{c(){e=k("h1"),e.textContent=t,s=S(),r=k("img"),a=S(),D(o.$$.fragment),this.h()},l(c){e=T(c,"H1",{class:!0,style:!0,"data-svelte-h":!0}),Q(e)!=="svelte-pcqv2h"&&(e.textContent=t),s=E(c),r=T(c,"IMG",{class:!0,src:!0,alt:!0}),a=E(c),U(o.$$.fragment,c),this.h()},h(){b(e,"class",""),K(e,"margin","0"),b(r,"class","not-prose object-cover object-center aspect-[3/4] w-full"),de(r.src,i="/images/MJP_20230927_Mui_Wo_jiu-jitsu_9342.jpg")||b(r,"src",i),b(r,"alt","Adult classes")},m(c,u){y(c,e,u),y(c,s,u),y(c,r,u),y(c,a,u),N(o,c,u),l=!0},p(c,u){const f={};u&65536&&(f.$$scope={dirty:u,ctx:c}),o.$set(f)},i(c){l||(j(o.$$.fragment,c),l=!0)},o(c){A(o.$$.fragment,c),l=!1},d(c){c&&(m(e),m(s),m(r),m(a)),F(o,c)}}}function Mi(n){let e,t="COMING SOON!",s,r,i="SIGN UP IF INTERESTED!";return{c(){e=k("h3"),e.textContent=t,s=S(),r=k("h4"),r.textContent=i,this.h()},l(a){e=T(a,"H3",{class:!0,"data-svelte-h":!0}),Q(e)!=="svelte-70awxa"&&(e.textContent=t),s=E(a),r=T(a,"H4",{"data-svelte-h":!0}),Q(r)!=="svelte-q8yjrt"&&(r.textContent=i),this.h()},h(){b(e,"class","")},m(a,o){y(a,e,o),y(a,s,o),y(a,r,o)},p:fe,d(a){a&&(m(e),m(s),m(r))}}}function zi(n){let e;return{c(){e=H("REGISTER")},l(t){e=B(t,"REGISTER")},m(t,s){y(t,e,s)},d(t){t&&m(e)}}}function Ji(n){let e,t="YOUTH CLASSES",s,r,i,a,o,l,c,u;return o=new Ye({props:{size:"sm",class:"w-full my-auto",$$slots:{default:[Mi]},$$scope:{ctx:n}}}),c=new oe({props:{class:"col-span-2 w-full place-self-end mt-auto",$$slots:{default:[zi]},$$scope:{ctx:n}}}),{c(){e=k("h1"),e.textContent=t,s=S(),r=k("img"),a=S(),D(o.$$.fragment),l=S(),D(c.$$.fragment),this.h()},l(f){e=T(f,"H1",{class:!0,style:!0,"data-svelte-h":!0}),Q(e)!=="svelte-1g5anvc"&&(e.textContent=t),s=E(f),r=T(f,"IMG",{class:!0,src:!0,alt:!0}),a=E(f),U(o.$$.fragment,f),l=E(f),U(c.$$.fragment,f),this.h()},h(){b(e,"class",""),K(e,"margin","0"),b(r,"class","not-prose object-cover object-center aspect-[3/4] w-full"),de(r.src,i="/images/MJP_20230927_Mui_Wo_jiu-jitsu_9376.jpg")||b(r,"src",i),b(r,"alt","Adult classes")},m(f,d){y(f,e,d),y(f,s,d),y(f,r,d),y(f,a,d),N(o,f,d),y(f,l,d),N(c,f,d),u=!0},p(f,d){const h={};d&65536&&(h.$$scope={dirty:d,ctx:f}),o.$set(h);const g={};d&65536&&(g.$$scope={dirty:d,ctx:f}),c.$set(g)},i(f){u||(j(o.$$.fragment,f),j(c.$$.fragment,f),u=!0)},o(f){A(o.$$.fragment,f),A(c.$$.fragment,f),u=!1},d(f){f&&(m(e),m(s),m(r),m(a),m(l)),F(o,f),F(c,f)}}}function Hi(n){let e,t,s,r;return e=new Et({props:{class:"flex flex-col gap-6 items-center w-full justify-self-end",$$slots:{default:[qi]},$$scope:{ctx:n}}}),s=new Et({props:{class:"flex flex-col gap-6 items-center w-full h-full justify-self-start",$$slots:{default:[Ji]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment),t=S(),D(s.$$.fragment)},l(i){U(e.$$.fragment,i),t=E(i),U(s.$$.fragment,i)},m(i,a){N(e,i,a),y(i,t,a),N(s,i,a),r=!0},p(i,a){const o={};a&65536&&(o.$$scope={dirty:a,ctx:i}),e.$set(o);const l={};a&65536&&(l.$$scope={dirty:a,ctx:i}),s.$set(l)},i(i){r||(j(e.$$.fragment,i),j(s.$$.fragment,i),r=!0)},o(i){A(e.$$.fragment,i),A(s.$$.fragment,i),r=!1},d(i){i&&m(t),F(e,i),F(s,i)}}}function Bi(n){let e,t;return e=new Me({props:{class:"grid grid-cols-1 md:grid-cols-2 gap-y-12 items-center ",sizes:"max-w-7xl w-fit",$$slots:{default:[Hi]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment)},l(s){U(e.$$.fragment,s)},m(s,r){N(e,s,r),t=!0},p(s,r){const i={};r&65536&&(i.$$scope={dirty:r,ctx:s}),e.$set(i)},i(s){t||(j(e.$$.fragment,s),t=!0)},o(s){A(e.$$.fragment,s),t=!1},d(s){F(e,s)}}}function Gi(n){let e,t=`<h2 class="" style="margin:0">GET IN TOUCH, <br/> YOUâLL BE GLAD YOU DID</h2> <p style="margin:0">Youâve had a look at the site. Youâre clearly Jiu-Jitsu-curious.
          Whether youâre big, small, young, old, male, female, a beast or a
          nerd, we have a home for you here.</p> <p style="margin:0">info@buffalojiujitsu.hk(+852) 9648 2270 1/F Buffalo Strength GymMui
          Wo, Lantau Island, Hong Kong</p>`,s,r,i,a,o,l;return r=new Ai({}),{c(){e=k("div"),e.innerHTML=t,s=S(),D(r.$$.fragment),i=S(),a=k("img"),this.h()},l(c){e=T(c,"DIV",{class:!0,"data-svelte-h":!0}),Q(e)!=="svelte-42e769"&&(e.innerHTML=t),s=E(c),U(r.$$.fragment,c),i=E(c),a=T(c,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){b(e,"class","flex flex-col gap-8"),de(a.src,o="/images/buffalo_travel_times.jpg")||b(a,"src",o),b(a,"alt","Travel times to Buffalo Jiu-Jitsu"),b(a,"class","object-contain not-prose md:col-span-2 max-w-7xl w-full rounded-sm")},m(c,u){y(c,e,u),y(c,s,u),N(r,c,u),y(c,i,u),y(c,a,u),l=!0},p:fe,i(c){l||(j(r.$$.fragment,c),l=!0)},o(c){A(r.$$.fragment,c),l=!1},d(c){c&&(m(e),m(s),m(i),m(a)),F(r,c)}}}function Vi(n){let e,t;return e=new Me({props:{class:"grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-8 items-start",sizes:"max-w-7xl w-full",$$slots:{default:[Gi]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment)},l(s){U(e.$$.fragment,s)},m(s,r){N(e,s,r),t=!0},p(s,r){const i={};r&65536&&(i.$$scope={dirty:r,ctx:s}),e.$set(i)},i(s){t||(j(e.$$.fragment,s),t=!0)},o(s){A(e.$$.fragment,s),t=!1},d(s){F(e,s)}}}function Ki(n){let e;return{c(){e=H("CONTACT US")},l(t){e=B(t,"CONTACT US")},m(t,s){y(t,e,s)},d(t){t&&m(e)}}}function Wi(n){let e;return{c(){e=H("LEARN MORE")},l(t){e=B(t,"LEARN MORE")},m(t,s){y(t,e,s)},d(t){t&&m(e)}}}function Yi(n){let e,t="WELCOME TO BUFFALO JIU-JITSU",s,r,i='<div class="rounded-full h-44 w-44 md:h-64 md:w-64 lg:h-80 lg:w-80 border-4 -translate-x-12 md:translate-x-6 lg:translate-x-12 border-primary flex items-center justify-center"><h4 class="" style="margin:0">PASSION</h4></div> <div class="rounded-full h-44 w-44 md:h-64 md:w-64 lg:h-80 lg:w-80 -mt-12 border-4 md:mt-0 border-primary flex items-center justify-center"><h4 class="" style="margin:0">COMMUNITY</h4></div> <div class="rounded-full h-44 w-44 md:h-64 md:w-64 lg:h-80 lg:w-80 -mt-12 border-4 translate-x-12 md:mt-0 md:-translate-x-6 lg:-translate-x-12 border-primary flex items-center justify-center"><h4 class="" style="margin:0">AFFORDABILITY</h4></div>',a,o,l,c,u,f;return l=new oe({props:{class:"w-full ",href:"/contact",$$slots:{default:[Ki]},$$scope:{ctx:n}}}),u=new oe({props:{class:"w-full",href:"/about",$$slots:{default:[Wi]},$$scope:{ctx:n}}}),{c(){e=k("h2"),e.textContent=t,s=S(),r=k("div"),r.innerHTML=i,a=S(),o=k("div"),D(l.$$.fragment),c=S(),D(u.$$.fragment),this.h()},l(d){e=T(d,"H2",{class:!0,style:!0,"data-svelte-h":!0}),Q(e)!=="svelte-k1ouuo"&&(e.textContent=t),s=E(d),r=T(d,"DIV",{class:!0,"data-svelte-h":!0}),Q(r)!=="svelte-1gvxu0r"&&(r.innerHTML=i),a=E(d),o=T(d,"DIV",{class:!0});var h=R(o);U(l.$$.fragment,h),c=E(h),U(u.$$.fragment,h),h.forEach(m),this.h()},h(){b(e,"class","mx-auto"),K(e,"margin","0"),b(r,"class","flex flex-col md:flex-row items-center justify-center mx-auto w-full"),b(o,"class","grid grid-cols-2 gap-4 md:gap-6 place-items-center w-full max-w-lg pt-12")},m(d,h){y(d,e,h),y(d,s,h),y(d,r,h),y(d,a,h),y(d,o,h),N(l,o,null),C(o,c),N(u,o,null),f=!0},p(d,h){const g={};h&65536&&(g.$$scope={dirty:h,ctx:d}),l.$set(g);const v={};h&65536&&(v.$$scope={dirty:h,ctx:d}),u.$set(v)},i(d){f||(j(l.$$.fragment,d),j(u.$$.fragment,d),f=!0)},o(d){A(l.$$.fragment,d),A(u.$$.fragment,d),f=!1},d(d){d&&(m(e),m(s),m(r),m(a),m(o)),F(l),F(u)}}}function Xi(n){let e,t,s,r,i,a,o;return a=new Me({props:{class:"grid place-items-center gap-y-12 z-10",sizes:"max-w-7xl w-full",margin:"",$$slots:{default:[Yi]},$$scope:{ctx:n}}}),{c(){e=k("img"),s=S(),r=k("div"),i=S(),D(a.$$.fragment),this.h()},l(l){e=T(l,"IMG",{src:!0,alt:!0,class:!0}),s=E(l),r=T(l,"DIV",{class:!0}),R(r).forEach(m),i=E(l),U(a.$$.fragment,l),this.h()},h(){de(e.src,t="/images/MJP_20230927_Mui_Wo_jiu-jitsu_9326.jpg")||b(e,"src",t),b(e,"alt",""),b(e,"class","not-prose w-full h-full absolute object-cover z-0"),b(r,"class","bg-black/60 w-full h-full absolute z-10")},m(l,c){y(l,e,c),y(l,s,c),y(l,r,c),y(l,i,c),N(a,l,c),o=!0},p(l,c){const u={};c&65536&&(u.$$scope={dirty:c,ctx:l}),a.$set(u)},i(l){o||(j(a.$$.fragment,l),o=!0)},o(l){A(a.$$.fragment,l),o=!1},d(l){l&&(m(e),m(s),m(r),m(i)),F(a,l)}}}function Qi(n){let e,t,s,r,i,a,o,l,c,u,f,d;return e=new Es({props:{CTAButtons:{},title:"BUFFALO JIU-JITSU",subtitle:"",justified:"center",bgImg:"/images/Screenshot.png",bgCover:"bg-black/60",parallax:!0}}),s=new we({props:{class:"-translate-y-36 -mb-36 z-0 rounded-t-[25px] bg-background pt-12 pb-32",$$slots:{default:[Pi]},$$scope:{ctx:n}}}),i=new we({props:{class:"bg-background py-12",$$slots:{default:[Di]},$$scope:{ctx:n}}}),o=new we({props:{class:"bg-background py-24 ",id:"classes",$$slots:{default:[Bi]},$$scope:{ctx:n}}}),c=new we({props:{class:"bg-background py-24 text-left",$$slots:{default:[Vi]},$$scope:{ctx:n}}}),f=new we({props:{class:"py-64",$$slots:{default:[Xi]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment),t=S(),D(s.$$.fragment),r=S(),D(i.$$.fragment),a=S(),D(o.$$.fragment),l=S(),D(c.$$.fragment),u=S(),D(f.$$.fragment)},l(h){U(e.$$.fragment,h),t=E(h),U(s.$$.fragment,h),r=E(h),U(i.$$.fragment,h),a=E(h),U(o.$$.fragment,h),l=E(h),U(c.$$.fragment,h),u=E(h),U(f.$$.fragment,h)},m(h,g){N(e,h,g),y(h,t,g),N(s,h,g),y(h,r,g),N(i,h,g),y(h,a,g),N(o,h,g),y(h,l,g),N(c,h,g),y(h,u,g),N(f,h,g),d=!0},p(h,g){const v={};g&65536&&(v.$$scope={dirty:g,ctx:h}),s.$set(v);const _={};g&65536&&(_.$$scope={dirty:g,ctx:h}),i.$set(_);const p={};g&65536&&(p.$$scope={dirty:g,ctx:h}),o.$set(p);const $={};g&65536&&($.$$scope={dirty:g,ctx:h}),c.$set($);const q={};g&65536&&(q.$$scope={dirty:g,ctx:h}),f.$set(q)},i(h){d||(j(e.$$.fragment,h),j(s.$$.fragment,h),j(i.$$.fragment,h),j(o.$$.fragment,h),j(c.$$.fragment,h),j(f.$$.fragment,h),d=!0)},o(h){A(e.$$.fragment,h),A(s.$$.fragment,h),A(i.$$.fragment,h),A(o.$$.fragment,h),A(c.$$.fragment,h),A(f.$$.fragment,h),d=!1},d(h){h&&(m(t),m(r),m(a),m(l),m(u)),F(e,h),F(s,h),F(i,h),F(o,h),F(c,h),F(f,h)}}}function Zi(n){let e,t;return e=new Ye({props:{size:"lg",class:"text-center",$$slots:{default:[Qi]},$$scope:{ctx:n}}}),{c(){D(e.$$.fragment)},l(s){U(e.$$.fragment,s)},m(s,r){N(e,s,r),t=!0},p(s,[r]){const i={};r&65536&&(i.$$scope={dirty:r,ctx:s}),e.$set(i)},i(s){t||(j(e.$$.fragment,s),t=!0)},o(s){A(e.$$.fragment,s),t=!1},d(s){F(e,s)}}}function en(n){return[[{title:"NO GI",body:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud.",img:"/images/MJP_20230927_Mui_Wo_jiu-jitsu_9172.jpg"},{title:"OUR METHOD",body:"lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. ut enim ad minim veniam, quis nostrud.",img:"/images/MJP_20230927_Mui_Wo_jiu-jitsu_9286.jpg"},{title:"THE VISION",body:"lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. ut enim ad minim veniam, quis nostrud.",img:"/images/MJP_20230927_Mui_Wo_jiu-jitsu_9288.jpg"}],[{label:"GUEST TRIAL",price:"FREE"},{label:"MONTHLY",price:"$750"},{label:"DAY PASS",price:"$150"}],[{day:"MON",time:"7:45PM"},{day:"WED",time:"7:45PM"},{day:"THURS",time:"7:45PM"}]]}class on extends me{constructor(e){super(),_e(this,e,en,Zi,ge,{})}}export{on as component};
